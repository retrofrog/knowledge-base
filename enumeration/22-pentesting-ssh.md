---
description: Cheatsheets for SSH
---

# 22 - Pentesting SSH

### Nmap Scripts

```bash
#How many "encryption_algorithms" are supported by the SSH server.
nmap --script ssh2-enum-algos 192.201.39.3
#What is the ssh-rsa host key being used by the SSH server.
nmap --script ssh-hostkey --script-args ssh_hostkey=full 192.201.39.3
#Which authentication method is being used by the SSH server for user “student”.
nmap -p 22 --script ssh-auth-methods --script-args="ssh.user=student" 192.201.39.3
#Fetch the flag from /home/student/FLAG by using nmap ssh-run script.
nmap -p 22 --script=ssh-run --script-args="ssh-run.cmd=cat /home/student/FLAG,ssh-run.username=student,ssh-run.password=" 192.201.39.3
#Brute force password using nmap script
echo "administrator" > users
nmap -p 22 --script ssh-brute --script-args userdb=/root/users 192.40.231.3
```

### Netcat

```bash
#Fetch the banner using netcat and check the version of SSH server.
nc 192.201.39.3 22
```

### Hydra

```bash
#Brute Force
hydra -l student -P /usr/share/wordlists/rockyou.txt 192.40.231.3 ssh -t 4
```

### SSH

```bash
#Fetch pre-login SSH banner.
ssh root@192.201.39.3
```
